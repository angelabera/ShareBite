<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - ShareBite</title>
    <link rel="stylesheet" href="css/style.css?v=darkmode-fix-1" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="icon" type="image/svg+xml" href="logo/logo.svg" />
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <style>
      /* Dashboard specific styles using ShareBite color scheme */
      body {
        background: var(
          --hero-gradient,
          linear-gradient(135deg, #667eea 0%, #764ba2 100%)
        );
        min-height: 100vh;
        padding-top: 80px;
        transition: background 0.3s ease, color 0.3s ease;
      }

      /* Dark mode support */
      body.dark-mode {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      }

      .dashboard-container {
        max-width: 1200px;
        margin: 1.5rem auto;
        padding: 0 1rem;
        background: transparent;
      }

      .dashboard-header {
        text-align: center;
        margin-bottom: 2rem;
        padding: 1.5rem 2rem;
        background: rgba(255, 255, 255, 0.95);
        border-radius: var(--card-radius, 16px);
        box-shadow: var(--shadow-heavy, 0 10px 40px rgba(0, 0, 0, 0.2));
        backdrop-filter: blur(10px);
        transition: background 0.3s ease;
      }

      body.dark-mode .dashboard-header {
        background: rgba(30, 30, 30, 0.95);
      }

      .dashboard-title {
        font-size: 2.2rem;
        font-weight: 700;
        color: var(--black, #212121);
        margin: 0;
        background: linear-gradient(
          135deg,
          var(--primary-color, #4caf50) 0%,
          var(--secondary-color, #ff6b35) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        transition: color 0.3s ease;
      }

      body.dark-mode .dashboard-title {
        color: var(--white, #ffffff);
      }

      .dashboard-subtitle {
        font-size: 1.1rem;
        color: var(--medium-gray, #9e9e9e);
        margin-top: 0.5rem;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      body.dark-mode .dashboard-subtitle {
        color: #aaa;
      }

      .charts-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
        gap: 1.5rem;
        padding: 0;
      }

      .chart-box {
        background: rgba(255, 255, 255, 0.95);
        border-radius: var(--card-radius, 16px);
        padding: 1.5rem;
        box-shadow: var(--shadow-heavy, 0 10px 40px rgba(0, 0, 0, 0.2));
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: var(--transition-medium, 0.3s ease);
        position: relative;
        overflow: hidden;
      }

      body.dark-mode .chart-box {
        background: rgba(30, 30, 30, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .chart-box::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(
          --primary-gradient,
          linear-gradient(135deg, #4caf50 0%, #81c784 100%)
        );
      }

      /* Disable chart box hover effect entirely */
      .chart-box:hover {
        transform: translateY(0);
        box-shadow: var(--shadow-heavy, 0 10px 40px rgba(0, 0, 0, 0.2));
      }

      .chart-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--black, #212121);
        margin-bottom: 1rem;
        text-align: center;
        position: relative;
        transition: color 0.3s ease;
      }

      body.dark-mode .chart-title {
        color: var(--white, #ffffff);
      }

      .chart-title::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 40px;
        height: 3px;
        background: var(
          --secondary-gradient,
          linear-gradient(135deg, #ff6b35 0%, #ffc107 100%)
        );
        border-radius: 2px;
      }

      /* Stats cards above charts */
      .stats-row {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.2rem;
        margin-bottom: 2rem;
        padding: 0;
        overflow: visible;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: var(--border-radius, 12px);
        padding: 1.2rem;
        text-align: center;
        box-shadow: var(--shadow-medium, 0 5px 25px rgba(0, 0, 0, 0.15));
        border-left: 4px solid var(--primary-color, #4caf50);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        min-height: 120px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        transform: translateY(0);
        position: relative;
      }

      body.dark-mode .stat-card {
        background: rgba(30, 30, 30, 0.95);
      }

      .stat-card:nth-child(2) {
        border-left-color: var(--secondary-color, #ff6b35);
      }

      .stat-card:nth-child(3) {
        border-left-color: var(--accent-color, #ffc107);
      }

      .stat-card:nth-child(4) {
        border-left-color: var(--primary-dark, #2e7d32);
      }

      /* Prevent any unwanted animations on child elements */
      .stat-card .stat-number,
      .stat-card .stat-label,
      .stat-card .stat-icon {
        transition: none;
        animation: none;
      }

      /* Ensure stable hover state - only on actual hover */
      .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
      }

      /* Ensure return to normal state when not hovering */
      .stat-card:not(:hover) {
        transform: translateY(0);
        box-shadow: var(--shadow-medium, 0 5px 25px rgba(0, 0, 0, 0.15));
      }

      .stat-number {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary-color, #4caf50);
        display: block;
        margin: 0.3rem 0;
      }

      .stat-card:nth-child(2) .stat-number {
        color: var(--secondary-color, #ff6b35);
      }

      .stat-card:nth-child(3) .stat-number {
        color: var(--accent-color, #ffc107);
      }

      .stat-card:nth-child(4) .stat-number {
        color: var(--primary-dark, #2e7d32);
      }

      .stat-label {
        font-size: 0.9rem;
        color: var(--medium-gray, #9e9e9e);
        font-weight: 500;
        margin-top: 0.5rem;
      }

      .stat-icon {
        font-size: 1.3rem;
        color: var(--primary-color, #4caf50);
        margin-bottom: 0.3rem;
      }

      .stat-card:nth-child(2) .stat-icon {
        color: var(--secondary-color, #ff6b35);
      }

      .stat-card:nth-child(3) .stat-icon {
        color: var(--accent-color, #ffc107);
      }

      .stat-card:nth-child(4) .stat-icon {
        color: var(--primary-dark, #2e7d32);
      }

      @media (max-width: 1200px) {
        .charts-row {
          grid-template-columns: 1fr;
        }

        .stats-row {
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
        }
      }

      @media (max-width: 768px) {
        body {
          padding-top: 70px;
        }

        .dashboard-container {
          margin: 1rem auto;
          padding: 0 0.5rem;
        }

        .dashboard-title {
          font-size: 1.8rem;
        }

        .dashboard-header {
          margin-bottom: 1.5rem;
          padding: 1rem;
        }

        .stats-row {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.8rem;
          margin-bottom: 1.5rem;
        }

        .stat-card {
          padding: 1rem;
          min-height: 100px;
        }

        .stat-number {
          font-size: 1.5rem;
        }

        .stat-icon {
          font-size: 1.1rem;
        }

        .chart-box {
          padding: 1rem;
        }

        .charts-row {
          gap: 1rem;
        }
      }

      @media (max-width: 480px) {
        .stats-row {
          grid-template-columns: 1fr;
        }

        .dashboard-title {
          font-size: 1.6rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation (copied from index.html) -->
    <nav class="navbar">
      <div class="nav-container">
        <div class="nav-logo">
          <a href="#home" class="nav-logo-link">
            <i class="fas fa-utensils"></i>
            <span>ShareBite</span>
          </a>
        </div>
        <ul class="nav-menu">
          <li><a href="#home" class="nav-link">Home</a></li>
          <li><a href="#features" class="nav-link">Features</a></li>
          <li><a href="foodlisting.html" class="nav-link">Listings</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
          <li><a href="#contact-section" class="nav-link">Contact</a></li>
        </ul>
        <div class="user-actions">
          <button
            id="themeToggle"
            class="theme-toggle"
            aria-label="Toggle dark mode"
          >
            <i class="fas fa-moon"></i>
          </button>
          <button class="login-btn" onclick="window.location.href='login.html'">
            Logout
          </button>
        </div>
        <div class="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </nav>
    <div class="dashboard-container">
      <div class="dashboard-header">
        <h1 class="dashboard-title">Admin Dashboard</h1>
        <p class="dashboard-subtitle">
          Monitor food donations and distribution analytics
        </p>
      </div>

      <!-- Stats Cards -->
      <div class="stats-row">
        <div class="stat-card">
          <i class="fas fa-utensils stat-icon"></i>
          <span class="stat-number">1,245</span>
          <span class="stat-label">Total Donations</span>
        </div>
        <div class="stat-card">
          <i class="fas fa-calendar-day stat-icon"></i>
          <span class="stat-number">87</span>
          <span class="stat-label">Today's Pickups</span>
        </div>
        <div class="stat-card">
          <i class="fas fa-users stat-icon"></i>
          <span class="stat-number">156</span>
          <span class="stat-label">Active Donors</span>
        </div>
        <div class="stat-card">
          <i class="fas fa-heart stat-icon"></i>
          <span class="stat-number">2,890</span>
          <span class="stat-label">Lives Impacted</span>
        </div>
      </div>

      <!-- Charts -->
      <div class="charts-row">
        <div class="chart-box">
          <h3 class="chart-title">Food Donations by Date</h3>
          <div id="barChart" style="width: 100%; height: 350px"></div>
        </div>
        <div class="chart-box">
          <h3 class="chart-title">Category Distribution</h3>
          <div id="pieChart" style="width: 100%; height: 350px"></div>
        </div>
      </div>
    </div>
    <script>
      // Initialize charts with theme support
      function initCharts() {
        try {
          const isDarkMode = document.body.classList.contains("dark-mode");
          const theme = isDarkMode ? "dark" : null;

          // Get chart containers
          const barChartDom = document.getElementById("barChart");
          const pieChartDom = document.getElementById("pieChart");

          if (!barChartDom || !pieChartDom) {
            console.error("Chart containers not found");
            return null;
          }

          // Dispose existing charts if they exist
          if (echarts.getInstanceByDom(barChartDom)) {
            echarts.getInstanceByDom(barChartDom).dispose();
          }
          if (echarts.getInstanceByDom(pieChartDom)) {
            echarts.getInstanceByDom(pieChartDom).dispose();
          }

          // Bar Chart Example - Food Donations by Date and Category
          var barChart = echarts.init(barChartDom, theme);
          var barOption = {
            animation: false,
            title: {
              text: "Food Donations by Date and Category",
              left: "center",
              top: "2%",
              textStyle: {
                fontSize: 16,
                fontWeight: "bold",
                color: isDarkMode ? "#ffffff" : "#333333",
              },
            },
            tooltip: {
              trigger: "axis",
              axisPointer: {
                type: "shadow",
                shadowStyle: {
                  color: "rgba(0,0,0,0.1)",
                },
              },
              confine: true,
              hideDelay: 100,
              formatter: function (params) {
                let total = 0;
                let tooltipContent =
                  "<strong>" + params[0].axisValue + "</strong><br/>";

                // Calculate total and build content
                params.forEach(function (item) {
                  total += item.value;
                });

                // Add total line
                tooltipContent +=
                  "<strong>Total: " + total + " kg</strong><br/><br/>";

                // Add each category
                params.forEach(function (item) {
                  tooltipContent +=
                    '<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:' +
                    item.color +
                    '"></span>';
                  tooltipContent +=
                    item.seriesName +
                    ": <strong>" +
                    item.value +
                    " kg</strong><br/>";
                });

                return tooltipContent;
              },
            },
            legend: {
              data: ["Fruits", "Vegetables", "Grains", "Dairy", "Others"],
              top: "12%",
              left: "center",
            },
            grid: {
              left: "10%",
              right: "4%",
              bottom: "8%",
              top: "25%",
              containLabel: true,
            },
            xAxis: {
              type: "category",
              data: ["Oct 09", "Oct 10", "Oct 11", "Oct 12", "Oct 13"],
              axisTick: {
                alignWithLabel: true,
              },
              axisLabel: {
                color: isDarkMode ? "#ffffff" : "#333333",
                fontSize: 11,
              },
              axisLine: {
                lineStyle: {
                  color: isDarkMode ? "#555555" : "#cccccc",
                },
              },
            },
            yAxis: {
              type: "value",
              name: "Donations (kg)",
              nameLocation: "middle",
              nameGap: 50,
              nameTextStyle: {
                fontSize: 12,
                fontWeight: "bold",
                color: isDarkMode ? "#ffffff" : "#333333",
              },
              nameRotate: 90,
              axisLabel: {
                color: isDarkMode ? "#ffffff" : "#333333",
                fontSize: 11,
              },
              axisLine: {
                lineStyle: {
                  color: isDarkMode ? "#555555" : "#cccccc",
                },
              },
              splitLine: {
                lineStyle: {
                  color: isDarkMode ? "#444444" : "#e0e0e0",
                },
              },
            },
            series: [
              {
                name: "Fruits",
                type: "bar",
                stack: "total",
                data: [25, 30, 20, 35, 28],
                itemStyle: { color: "#4CAF50" },
                emphasis: { focus: "none" },
              },
              {
                name: "Vegetables",
                type: "bar",
                stack: "total",
                data: [40, 45, 35, 50, 42],
                itemStyle: { color: "#81C784" },
                emphasis: { focus: "none" },
              },
              {
                name: "Grains",
                type: "bar",
                stack: "total",
                data: [30, 25, 40, 28, 35],
                itemStyle: { color: "#FF6B35" },
                emphasis: { focus: "none" },
              },
              {
                name: "Dairy",
                type: "bar",
                stack: "total",
                data: [15, 20, 18, 22, 19],
                itemStyle: { color: "#FFC107" },
                emphasis: { focus: "none" },
              },
              {
                name: "Others",
                type: "bar",
                stack: "total",
                data: [12, 18, 15, 20, 16],
                itemStyle: { color: "#2E7D32" },
                emphasis: { focus: "none" },
              },
            ],
          };
          barChart.setOption(barOption, true);

          // Pie Chart Example
          var pieChart = echarts.init(pieChartDom, theme);
          var pieOption = {
            animation: false,
            title: {
              text: "Donation Distribution",
              left: "center",
              top: "2%",
              textStyle: {
                fontSize: 16,
                fontWeight: "bold",
                color: isDarkMode ? "#ffffff" : "#333333",
              },
            },
            tooltip: {
              trigger: "item",
              confine: true,
              hideDelay: 100,
            },
            legend: {
              orient: "vertical",
              left: "left",
              top: "15%",
            },
            series: [
              {
                name: "Donations",
                type: "pie",
                radius: "60%",
                data: [
                  {
                    value: 335,
                    name: "Fruits",
                    itemStyle: { color: "#4CAF50" },
                  },
                  {
                    value: 310,
                    name: "Vegetables",
                    itemStyle: { color: "#81C784" },
                  },
                  {
                    value: 234,
                    name: "Grains",
                    itemStyle: { color: "#FF6B35" },
                  },
                  {
                    value: 135,
                    name: "Dairy",
                    itemStyle: { color: "#FFC107" },
                  },
                  {
                    value: 154,
                    name: "Others",
                    itemStyle: { color: "#2E7D32" },
                  },
                ],
                emphasis: {
                  itemStyle: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: "rgba(0, 0, 0, 0.5)",
                  },
                },
              },
            ],
          };
          pieChart.setOption(pieOption, true);

          return { barChart, pieChart };
        } catch (error) {
          console.error("Error initializing charts:", error);
          return null;
        }
      }

      // Initialize charts when DOM is ready
      document.addEventListener("DOMContentLoaded", function () {
        let charts = initCharts();

        // Re-initialize charts when theme changes
        const themeToggle = document.getElementById("themeToggle");
        if (themeToggle) {
          themeToggle.addEventListener("click", () => {
            setTimeout(() => {
              // Reinitialize with new theme
              charts = initCharts();
            }, 100);
          });
        }

        // Handle window resize
        window.addEventListener("resize", () => {
          if (charts && charts.barChart) charts.barChart.resize();
          if (charts && charts.pieChart) charts.pieChart.resize();
        });
      });
    </script>
    <script src="js/theme.js"></script>
  </body>
</html>
