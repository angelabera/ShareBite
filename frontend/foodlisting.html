<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ShareBite - Food Listing</title>
    <meta name="sharebite-build" content="v-darkmode-fix-1">
    <link rel="stylesheet" href="css/style.css?v=darkmode-fix-1">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"> -->
        <link rel="stylesheet" href="./css/fontawesome/all.min.css">
 
    <link rel="icon" type="image/svg+xml" href="logo/logo.svg">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Leaflet Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-utensils"></i>
                <span>ShareBite</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link" data-i18n="nav.home">Home</a></li>
                <li><a href="index.html#features" class="nav-link" data-i18n="nav.features">Features</a></li>
                <li><a href="foodlisting.html" class="nav-link" data-i18n="nav.listings">Listings</a></li>
                <li><a href="index.html#about" class="nav-link" data-i18n="nav.about">About</a></li>
                <li><a href="index.html#contact" class="nav-link" data-i18n="nav.contact">Contact</a></li>
            </ul>
            <div class="user-actions">
                <!-- Added dark mode toggle -->
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                
                <!-- Notification Bell -->
                <div class="notification-bell" id="notificationBell" style="display: none;">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                    <div class="notification-panel" id="notificationPanel">
                        <div class="notification-header" data-i18n="listings.notification.header">Claimed Food Items</div>
                        <div id="notificationList">
                             <div class="no-notifications" data-i18n="listings.notification.no_items">No claimed items yet</div>
                        </div>
                    </div>
                </div>

                <button class="role-switch" id="roleSwitch">
                    <i class="fas fa-exchange-alt"></i>
                    <span id="currentRole" data-i18n="role.donor">Donor</span>
                </button>
                <button class="login-btn" onclick="window.location.href='login.html'">Login as User</button>
                <button class="login-btn" onclick="window.location.href='login_ngo.html'">Login as NGO</button>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Food Listings Section -->
    <section id="listings" class="listings">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title" data-i18n="listings.title">Food Listings</h2>
                <p class="section-subtitle" data-i18n="listings.subtitle">Available food waiting to be collected</p>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <button class="filter-btn active" data-filter="all" data-i18n="listings.filter.all">All</button>
                    <button class="filter-btn" data-filter="restaurant" data-i18n="listings.filter.restaurant">Restaurant</button>
                    <button class="filter-btn" data-filter="household" data-i18n="listings.filter.household">Household</button>
                    <button class="filter-btn" data-filter="bakery" data-i18n="listings.filter.bakery">Bakery</button>
                </div>
                <div class="dropdown-check-container">
                    <button class="dropdown-btn" id="dietary-filter-btn">
                        <span data-i18n="listings.dietaryFilters">Dietary Filters</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content" id="dietary-dropdown">
                        <label><input type="checkbox" name="dietary-filter" value="vegetarian"> <span data-i18n="listings.dietary.vegetarian">Vegetarian</span></label>
                        <label><input type="checkbox" name="dietary-filter" value="vegan"> <span data-i18n="listings.dietary.vegan">Vegan</span></label>
                        <label><input type="checkbox" name="dietary-filter" value="gluten-free"> <span data-i18n="listings.dietary.gluten-free">Gluten-Free</span></label>
                        <label><input type="checkbox" name="dietary-filter" value="dairy-free"> <span data-i18n="listings.dietary.dairy-free">Dairy-Free</span></label>
                        <label><input type="checkbox" name="dietary-filter" value="non-vegetarian"> <span data-i18n="listings.dietary.non-vegetarian">Non-Vegetarian</span></label>
                    </div>
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" data-i18n-attr="placeholder" data-i18n="listings.search_placeholder" />
                </div>
                <button class="add-listing-btn" id="addListingBtn">
                    <i class="fas fa-plus"></i>
                    <span data-i18n="listings.add_listing">Add Listing</span>
                </button>
            </div>

            <!-- Food Cards Grid -->
            <div class="food-grid" id="foodGrid">
                <!-- Sample listings will be generated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Add Listing Modal -->
    <div class="modal" id="addListingModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 data-i18n="listings.modal.title">Add Food Listing</h3>
          <button class="close-modal">&times;</button>
        </div>

        <!-- Progress Bar -->
        <div class="form-progress">
          <div class="progress-step active" data-step="1">
            <div class="step-circle">1</div>
            <span class="step-label" data-i18n="listings.modal.steps.1">Food Details</span>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="2">
            <div class="step-circle">2</div>
            <span class="step-label" data-i18n="listings.modal.steps.2">Pickup Info</span>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="3">
            <div class="step-circle">3</div>
            <span class="step-label" data-i18n="listings.modal.steps.3">Photo & Review</span>
          </div>
        </div>

        <form class="listing-form" id="listingForm">
          <!-- Step 1: Food Details -->
          <div class="form-step active" data-step="1">
            <h4 class="step-title" data-i18n="listings.modal.step_titles.food_details">Tell us about the food</h4>
            <div class="form-group">
              <label for="foodType" data-i18n="listings.modal.form_labels.foodType">Food Type *</label>
              <input
                type="text"
                id="foodType"
                required
                data-i18n-attr="placeholder"
                data-i18n="listings.modal.placeholders.foodType"
              />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="quantity" data-i18n="listings.modal.form_labels.quantity">Quantity *</label>
                <input
                  type="text"
                  id="quantity"
                  required
                  data-i18n-attr="placeholder"
                  data-i18n="listings.modal.placeholders.quantity"
                />
              </div>
              <div class="form-group">
                <label for="category" data-i18n="listings.modal.form_labels.category">Category *</label>
                <select id="category" required>
                  <option value="" data-i18n="listings.modal.placeholders.select">Select Category</option>
                  <option value="restaurant" data-i18n="listings.filter.restaurant">Restaurant</option>
                  <option value="household" data-i18n="listings.filter.household">Household</option>
                  <option value="bakery" data-i18n="listings.filter.bakery">Bakery</option>
                  <option value="event" data-i18n="listings.filter.event">Event</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="description" data-i18n="listings.modal.form_labels.description">Description</label>
              <textarea
                id="description"
                rows="3"
                data-i18n-attr="placeholder"
                data-i18n="listings.modal.placeholders.description"
              ></textarea>
            </div>
            <div class="form-group">
              <label>Dietary Information (optional)</label>
              <div class="checkbox-group">
                  <div><input type="checkbox" id="tag-vegetarian" name="dietary" value="vegetarian"><label for="tag-vegetarian">Vegetarian</label></div>
                  <div><input type="checkbox" id="tag-vegan" name="dietary" value="vegan"><label for="tag-vegan">Vegan</label></div>
                  <div><input type="checkbox" id="tag-gluten-free" name="dietary" value="gluten-free"><label for="tag-gluten-free">Gluten-Free</label></div>
                  <div><input type="checkbox" id="tag-nut-free" name="dietary" value="nut-free"><label for="tag-nut-free">Nut-Free</label></div>
              </div>
            </div>
          </div>

          <!-- Step 2: Pickup Info -->
          <div class="form-step" data-step="2">
            <h4 class="step-title">When and where to pick up?</h4>
            <div class="form-row">
              <div class="form-group">
                <label for="freshUntil">Fresh Until *</label>
                <div class="input-container-relative">
                  <input type="datetime-local" id="freshUntil" class="datetime-input" required />
                  <span class="checkmark-icon">✓</span>
                </div>
              </div>
              <div class="form-group">
                <label for="pickupTime">Preferred Pickup Time *</label>
                <div class="input-container-relative">
                  <input type="time" id="pickupTime" class="datetime-input" required />
                  <span class="checkmark-icon-time">✓</span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="location">Pickup Location *</label>
              <input type="text" id="location" required placeholder="Address or landmark" />
            
              
            
              <div id="map" style="display:none; margin-top:10px; height: 250px; width: 100%; border-radius: 8px;"></div>
            
              <!-- Hidden inputs to send to backend -->
              <input type="hidden" id="latitude" />
              <input type="hidden" id="longitude" />
            </div>
            
            <div class="form-group">
              <label for="contact">Contact Information *</label>
              <input
                type="text"
                id="contact"
                required
                placeholder="Phone number or email"
              />
            </div>
          </div>

          <!-- Step 3: Photo & Review -->
          <div class="form-step" data-step="3">
            <h4 class="step-title">Add a photo (optional)</h4>
            <div class="form-group">
              <label for="photo">Food Photo</label>
              <input
                type="file"
                id="photo"
                accept="image/*"
                style="display: none"
              />
              <div class="file-upload-area" id="photoUpload">
                <i class="fas fa-cloud-upload-alt"></i>
                <span data-i18n="listings.modal.placeholders.fileUpload">Drag & drop your image here or click to browse</span>
                <small data-i18n="listings.modal.placeholders.supports">Supports: JPG, PNG, GIF (Max 5MB)</small>
              </div>
              <div id="imagePreview" class="image-preview"></div>
            </div>
          </div>

          <div class="form-navigation">
            <button
              type="button"
              class="btn btn-secondary"
              id="prevStep"
              style="display: none"
            >
              <i class="fas fa-arrow-left"></i> <span data-i18n="listings.modal.buttons.previous">Previous</span>
            </button>
            <button type="button" class="btn btn-secondary" id="cancelForm">
              <span data-i18n="listings.modal.buttons.cancel">Cancel</span>
            </button>
            <button type="button" class="btn btn-primary" id="nextStep">
              <span data-i18n="listings.modal.buttons.next">Next</span> <i class="fas fa-arrow-right"></i>
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              id="submitForm"
              style="display: none"
            >
              <i class="fas fa-check"></i> <span data-i18n="listings.modal.buttons.submit">Add Listing</span>
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner">
        <div class="spinner"></div>
        <p data-i18n="listings.modal.buttons.loading">Loading ShareBite...</p>
      </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/foodlisting.js"></script>
    
    <!-- ShareBite Chatbot -->
    <script type="module" src="../src/chatbot/ChatbotWidget.js"></script>
</body>

</html>